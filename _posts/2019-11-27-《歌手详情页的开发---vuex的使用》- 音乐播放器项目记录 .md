---
layout:     post   				    # 使用的布局（不需要改）
title:      音乐播放器项目记录 				# 标题 
subtitle:   《歌手详情页的开发---vuex的使用》 #副标题
date:       2019-11-27 				# 时间
author:     Charlene 						# 作者
header-img: img/js1.jpg 	#这篇文章标题背景图片
catalog: true 						# 是否归档
tags:								#标签
    - 音乐播放器项目记录
---
```
### 歌手详情界面的开发：

singer-detail组建的开发：创建并编写简单的页面<br>

在index.js中重新配置路由，点击歌手就可以转到详情列表了<br>
```
{
  path: '/singer',
  component: Singer,
  children: [
    {
      path: ':id',
      component: SingerDetail
    }
  ]
}
```
配置好子路由之后，要有一个routerview去承载这个子路由，我们回到singer组件，在list-view（歌手列表组件）的下边挂载子router-view<br>
```
<template>
  <div class="singer">
    <!-- 将singers数据命名为data变量传递给listview.vue组件 -->
    <list-view @select="selectSinger" :data="singers"></list-view>
    <!-- 承载子路由SingerDetail -->
    <router-view></router-view>
  </div>
</template>
```
添加路由跳转逻辑，我们希望我们点击歌手列表的时候，可以进行路由跳转，歌手列表基于list-view实现，所以在listview组件中，添加一个点击事件selectItem();<br>
```
<ul>
  <!-- 这里面的每一个li代表每个组别里面的每一位歌手 -->
  <li @click="selectItem(item)" v-for="(item, index) in group.items" :key="index" class="list-group-item">
    <img class="avatar" v-lazy="item.avatar">
    <span class="name">{{item.name}}</span>
  </li>
</ul>
```
在listview中添加点击事件并将item派发出去，点击事件没有业务逻辑，仅仅是将数据传出去<br>
```
selectItem(item) {
  this.$emit('select', item) // 将点击的是哪一位歌手派发出去
},
```
回到singer.vue界面监听函数<br>
```
<!-- 将singers数据命名为data变量传递给listview.vue组件 -->
<list-view @select="selectSinger" :data="singers"></list-view>
```
methods中实现监听函数
```
 selectSinger(singer) {
        this.$router.push({
          path: `/singer/${singer.id}`  // // router的编程式跳转接口
        })
       // this.setSinger(singer)
       console.log(`${singer.id}`)
      },
```
点击歌手出现歌手详情，但是界面的跳转略显生硬，我们为singer-detail的跳转增加一个transition动画
```
<template>
  <transition name="slide">
      <music-list :songs="songs" :title="title" :bg-image="bgImage"></music-list>
  </transition>
</template>
```
```
.slide-enter-active, .slide-leave-active
    transition all 0.3s
.slide-enter, .slide-leave-to
    transform translate3d(100%, 0, 0)
```
当我们点击歌手列表切换到歌手详情页的时候，需要把歌手的数据，歌手的名称，图片等，通过参数的传递也是可以解决的，利用vuex解决这个问题也可。

state：所有组件的所有状态和数据，放在同一的内存空间来管理

vue Components：state中的数据可以映射到组件上来渲染组件

Action：当组件中的数据发生变化的时候，Component可以通过dispatch一个action，action会做一些异步操作，

mutation：Action commit到mutation，他是唯一一个可以修改state的途径，其他任何方式修改state都是非法的

使用场景：解决多个组件之间的状态共享，这些组件可能是一些关联度很低的组件，所以我们想要共享数据就比较困难

                比如遇到一些路由跳转场景，如果我们传递的参数很复杂的话，vuex是很好的选择


3.vuex可以解决多个组件之间的状态共享，路由间的复杂数据传递，

index.js: vuex的入口函数src->store->index.js，

state.js: 状态管理：src->store->state.js，

mutation建立mutations.js，

mutation-types: 与mutation相关的mutation名字的文件叫mutation-types，存储于mutation相关的字符串常亮，

actions.js：异步修改，或者对mutation做一些封装，

getters.js对state数据进行映射，

首先，定义state.js


————————————————
版权声明：本文为CSDN博主「qq_22317389」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。
原文链接：https://blog.csdn.net/qq_22317389/article/details/81226315
